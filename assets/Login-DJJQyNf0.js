import{r as o,u as j,A as N,j as t,L as I}from"./index-B9FQTHBN.js";import{y as r,A as p}from"./CONSTANTS-7ARGwVCX.js";/* empty css                      */import{G as v}from"./GetAPI-C0R9K2iB.js";import{l as L}from"./authUtils-Cl3aMeRo.js";import"./config-BbshSSl6.js";const R=()=>{const[l,m]=o.useState({username:"",password:""}),[d,i]=o.useState(!1),g=o.useRef(null),f=o.useRef(null),x=o.useRef(null),a=j(),{usid:u}=N(),b=()=>{const e=localStorage.getItem("loginTime"),s=new Date().getTime(),n=1440*60*1e3;e&&s-e>n&&(localStorage.clear(),r.warning("Session expired. Please login again.",{position:"top-right",autoClose:2e3}),a("/login"))};o.useEffect(()=>{b(),u&&y(u)},[u,a]),o.useEffect(()=>{if(window.location.pathname==="/login"){const e=localStorage.getItem("uid"),s=localStorage.getItem("aid");e>0&&a("/home"),s==="true"&&!e&&a("/admin")}},[a]),o.useEffect(()=>{var e;(e=x.current)==null||e.focus()},[]);const y=async e=>{localStorage.clear();try{i(!0);const{data:s}=await v(`login/${e}`);s?(r.success("Login Successful",{autoClose:2e3}),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("udt",JSON.stringify(s)),localStorage.setItem("uid",s.userID),localStorage.setItem("usid",e),localStorage.setItem("loginTime",new Date().getTime()),a("/home")):r.warning("Kindly login with your credentials",{autoClose:2e3})}catch(s){console.error("Error in direct login:",s)}finally{i(!1)}},w=async()=>{const{username:e,password:s}=l;if(!e||!s){r.error("Please enter both username and password.");return}try{i(!0);const n=await L({mobileNumber:e,password:s}),{code:S,message:h,data:c}=n;S===200?(r.success(h,{autoClose:2e3}),localStorage.clear(),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("udt",JSON.stringify(c)),localStorage.setItem("uid",c.userID),localStorage.setItem("loginTime",new Date().getTime()),e==="7598548786"?(localStorage.setItem("aid","true"),localStorage.setItem("usid",c.usid),a("/admin")):(localStorage.setItem("usid",c.usid),a("/home"))):r.error(h,{autoClose:2e3})}catch(n){r.error("An error occurred: "+n.message,{autoClose:3e3})}finally{i(!1)}};return t.jsxs(t.Fragment,{children:[d&&t.jsx(I,{}),t.jsx("div",{className:"hidden md:block absolute inset-0 overflow-hidden z-0",children:t.jsx("img",{src:`${p.BG_PRIMARY}`,alt:"background",className:"w-full h-full object-cover transition-opacity"})}),t.jsx("div",{className:"relative flex min-h-screen items-center justify-center",children:t.jsxs("div",{className:"relative z-10 w-full max-w-md p-8 md:p-12",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("a",{href:"/",children:t.jsx("img",{src:p.LOGO,alt:"Company Logo",className:"mx-auto w-40 md:w-48"})}),t.jsx("h2",{className:"mt-8 text-left text-lg font-semibold text-gray-800",children:"Sign in to your account"}),t.jsx("p",{className:"mb-4 text-left text-xs text-gray-600",children:"Welcome! Please fill in your username and password to log in."})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"username",className:"mb-2 block text-sm text-gray-600",children:"Mobile Number"}),t.jsx("input",{type:"number",id:"username",ref:x,placeholder:"Enter your mobile number",autoComplete:!0,maxLength:12,tabIndex:"1",value:l.username,onChange:e=>m({...l,username:e.target.value}),onKeyUp:e=>{var s;e.key==="Enter"&&((s=f.current)==null||s.focus())},className:"w-full rounded-md border px-3 py-2 focus:border-blue-400 focus:ring focus:ring-blue-300"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"password",className:"mb-2 block text-sm text-gray-600",children:"Password"}),t.jsx("input",{type:"password",id:"password",placeholder:"Enter your password",ref:f,tabIndex:"2",value:l.password,onChange:e=>{const s=e.target.value;if(s.length>8){r.error("Password must be max 8 characters",{autoClose:2e3});return}m({...l,password:s})},onKeyUp:e=>{var s;e.key==="Enter"&&((s=g.current)==null||s.click())},className:"w-full rounded-md border px-3 py-2 focus:border-blue-400 focus:ring focus:ring-blue-300"}),t.jsx("p",{className:"mt-1 w-full text-end text-xs",children:t.jsx("a",{href:"/forget-password",className:"text-blue-600 hover:underline",children:"Forgot your password?"})})]}),t.jsx("button",{type:"button",ref:g,onClick:w,className:"w-full rounded-md bg-blue-700 px-4 py-2 text-white hover:bg-blue-600 focus:ring focus:ring-blue-300",children:d?"Logging in...":"Login"}),t.jsxs("p",{className:"mt-6 text-center text-sm text-gray-500",children:["Don't have an account yet?"," ",t.jsx("a",{href:"/register",className:"font-medium text-blue-600 hover:underline",children:"Sign up"})]})]})})]})};export{R as default};
