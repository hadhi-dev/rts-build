import{j as e,L as U}from"./index-CZKKA0SR.js";import{c as O}from"./config-BbshSSl6.js";import{G as P}from"./GetAPI-C0R9K2iB.js";import{f as J}from"./rtsApi-Dl_EsLra.js";import{r as a,f as M,e as H}from"./react-vendor-DWPARcIf.js";import{y as l}from"./ui-vendor-TdGwSbkz.js";import{S as L}from"./Sidebar-CLAYmXk_.js";import{T as q,D as G,R as B,C as V,I as Y}from"./Interviews-CtiPIYK3.js";import{m as z,n as F,o as A,p as E,q as K,e as T}from"./index-DucPhvMM.js";import{P as Q}from"./PostAPI-Dm7qi3aC.js";import"./icons-vendor-iI49wpkt.js";import"./ButtonMini-B2ysNCq4.js";import"./moment-BndZFSQF.js";import"./memoize-one.esm-DQq2xVVF.js";import"./react-select.esm-BGwzlP6T.js";const W=({job_app_uuid:o})=>{const[r,c]=a.useState(!1),[d,u]=a.useState(""),[x,j]=a.useState(!1),[i,m]=a.useState(null),[I,n]=a.useState(!0),f=`${window.location.origin}/profile/${o}`;a.useEffect(()=>{h()},[o]);const h=async()=>{try{n(!0);const s=await P(`rts/job_applications/${o}/candidateDetails`);if(s&&s.data&&s.data.job_application){const{code:g,access_token:b,interviewed_data:k}=s.data.job_application;g&&b&&m({code:g,access_token:b,interviewed_data:k?JSON.parse(k):null})}}catch(s){console.error("Error fetching Flowmingo data:",s)}finally{n(!1)}},w=()=>{navigator.clipboard.writeText(f).then(()=>{c(!0),l.success("Profile link copied to clipboard!"),setTimeout(()=>c(!1),2e3)}).catch(s=>{console.error("Failed to copy: ",s),l.error("Failed to copy link. Please try again.")})},v=()=>{window.open(f,"_blank")},N=async()=>{if(!d.trim()){l.error("Please paste the Flowmingo interview link");return}if(!d.includes("talent.flowmingo.ai/submission/")){l.error("Invalid Flowmingo link format. Please check the URL.");return}try{j(!0);const s=await Q("rts/job_applications/save-flowmingo-interview",{job_app_uuid:o,flowmingo_link:d});s&&s.code===200?(l.success("Interview data saved successfully!"),u(""),await h()):l.error((s==null?void 0:s.message)||"Failed to save interview data")}catch(s){console.error("Error saving Flowmingo data:",s),l.error("Failed to save interview data. Please try again.")}finally{j(!1)}},C=()=>{if(i){const s=`https://talent.flowmingo.ai/submission${i.code}?access_token=${i.access_token}`;navigator.clipboard.writeText(s).then(()=>{l.success("Flowmingo profile link copied!")}).catch(g=>{console.error("Failed to copy: ",g),l.error("Failed to copy link. Please try again.")})}},y=()=>{if(i){const s=`https://talent.flowmingo.ai/submission${i.code}?access_token=${i.access_token}`;window.open(s,"_blank")}};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-8 text-white",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(z,{className:"text-2xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Share Candidate Profile"}),e.jsx("p",{className:"text-indigo-100 text-sm mt-1",children:"Share this profile with HR or hiring managers"})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("i",{className:"bi bi-info-circle text-blue-600 text-xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"Public Profile Link"}),e.jsx("p",{className:"text-sm text-blue-700",children:"This link can be shared with anyone. No login required to view the candidate's profile."})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Profile URL"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-300 rounded-lg px-4 py-3 font-mono text-sm text-gray-700 break-all",children:f})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("button",{onClick:w,className:`flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all ${r?"bg-green-500 text-white":"bg-indigo-600 text-white hover:bg-indigo-700 hover:shadow-md"}`,children:r?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"text-lg"}),e.jsx("span",{children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"text-lg"}),e.jsx("span",{children:"Copy Link"})]})}),e.jsxs("button",{onClick:v,className:"flex items-center justify-center gap-2 px-6 py-3 bg-white border-2 border-indigo-600 text-indigo-600 rounded-lg font-semibold hover:bg-indigo-50 transition-all",children:[e.jsx(E,{className:"text-lg"}),e.jsx("span",{children:"Open in New Tab"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx("i",{className:"bi bi-lightbulb text-yellow-500"}),"Usage Tips"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"bi bi-check-circle-fill text-green-500 mt-0.5"}),e.jsx("span",{children:"Share this link via email, messaging apps, or embed it in your ATS"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"bi bi-check-circle-fill text-green-500 mt-0.5"}),e.jsx("span",{children:"Recipients can view the profile without logging in"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"bi bi-check-circle-fill text-green-500 mt-0.5"}),e.jsx("span",{children:"Profile includes resume, skills, and application details"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mt-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-600 px-6 py-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(K,{className:"text-2xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Flowmingo Interview Integration"}),e.jsx("p",{className:"text-purple-100 text-sm mt-1",children:"Import interview data from Flowmingo"})]})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[i&&e.jsx("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-5 space-y-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(T,{className:"text-green-600 text-2xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-2 flex items-center gap-2",children:"Interview Data Available"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"Flowmingo interview has been integrated successfully."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:[e.jsx(F,{className:"text-xs"}),"Code Saved"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:[e.jsx(F,{className:"text-xs"}),"Access Token Saved"]}),i.interviewed_data&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:[e.jsx(T,{className:"text-xs"}),"Interview Data Available"]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Flowmingo Profile URL"}),e.jsxs("div",{className:"bg-white border border-green-300 rounded-lg px-3 py-2 font-mono text-xs text-gray-700 break-all",children:["https://talent.flowmingo.ai/submission",i.code,"?access_token=",i.access_token.substring(0,20),"..."]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition-all",children:[e.jsx(A,{}),"Copy Flowmingo Link"]}),e.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-white border-2 border-green-600 text-green-600 rounded-lg text-sm font-semibold hover:bg-green-50 transition-all",children:[e.jsx(E,{}),"Open Profile"]})]})]})]})}),e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-purple-700",children:i?"You can update the interview data by pasting a new Flowmingo link below.":"Paste the Flowmingo interview submission link below to automatically import and save the interview data."})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Flowmingo Interview Link ",i&&e.jsx("span",{className:"text-xs text-gray-500",children:"(Update)"})]}),e.jsx("input",{type:"text",value:d,onChange:s=>u(s.target.value),placeholder:"https://talent.flowmingo.ai/submission/xxxxx?access_token=xxxxx",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all text-sm",disabled:x}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Example: https://talent.flowmingo.ai/submission/0e14ccca0cdf1fc24fb9ef00e9389ccc8ff10d1b?access_token=a1da164e..."})]}),e.jsx("button",{onClick:N,disabled:x||!d.trim(),className:"w-full md:w-auto px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg font-semibold hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Processing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("span",{children:[i?"Update":"Save"," Interview Data"]})]})})]})]})]})},ge=()=>{const{job_app_uuid:o}=M(),r=H(),[c,d]=a.useState(0),[u,x]=a.useState(!1),[j,i]=a.useState({}),[m,I]=a.useState({}),[n,f]=a.useState({}),[h,w]=a.useState(""),[v,N]=a.useState(""),[C,y]=a.useState(null),[s,g]=a.useState([]),b=(t,S)=>{t==="logout"?(localStorage.clear(),r("/rts/login")):r("/rts/"+t)},k=()=>{r(-1)};a.useEffect(()=>{if(!localStorage.getItem("rts_user_uuid")){l.error("Please login to view candidate details"),r("/rts/login");return}o&&($(),D()),d(0)},[o,r]),a.useEffect(()=>{n!=null&&n.application_id&&R()},[n]);const $=async()=>{try{const t=await P("rts/stage_status");t&&g(t)}catch(t){console.error("Error fetching stage status:",t)}},R=async()=>{try{const t=await J(n.application_id);if(t.application){const S=t.application.application_status,p=s.find(_=>_.id==S);p&&(w(p.stage_name),N(p.status_name),y(p.id))}}catch(t){console.error("Error fetching application details:",t)}},D=async()=>{try{x(!0);const t=await P(`rts/job_applications/${o}/candidateDetails`);if(t&&t.data){const{job:S,candidate:p,job_application:_}=t.data;i(S),f(_),I(p)}else console.error("Unexpected API response format:",t),l.error("Failed to load candidate details"),r(-1)}catch(t){console.error("Error fetching job details:",t),l.error("Error loading candidate details"),r(-1)}finally{x(!1)}};return u?e.jsxs("div",{className:"flex flex-col h-screen bg-gray-50 w-full",children:[e.jsx(L,{activeComponent:"jobs",onMenuClick:b}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(U,{})})]}):e.jsxs("div",{className:"flex flex-col h-screen bg-gray-50 w-full overflow-hidden",children:[e.jsx(L,{activeComponent:"jobs",onMenuClick:b}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:e.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:[e.jsx("div",{className:"flex-shrink-0 bg-white shadow-sm border-b border-gray-200",children:e.jsx(q,{activeTab:c,setActiveTab:d,currentStage:h,currentStatus:v,candidate:m,closeModal:k})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[c===0&&e.jsx(G,{candidate:m,fetchJobDetails:D}),c===1&&e.jsx(B,{resumeURL:`${O.API_URL}rts/file/get-file?file=${m.resume_url}`}),c===2&&e.jsx(V,{job:j,job_application:n,candidate:m,stageStatus:s,data:{currentStage:h,setCurrentStage:w,currentStatus:v,setCurrentStatus:N,currentStageStatusID:C,setCurrentStageStatusID:y}}),c===3&&e.jsx(Y,{job_application:n,stageStatus:s}),c===4&&e.jsx(W,{job_app_uuid:o})]})})]})})]})};export{ge as default};
