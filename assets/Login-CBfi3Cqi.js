import{r,u as S,R as I,S as L,H as i,j as e,L as C,m as s}from"./index-a-2xoVB0.js";import{A as T}from"./CONSTANTS-W_7WszVf.js";import{G as P}from"./GetAPI-C0R9K2iB.js";import{l as k}from"./authUtils-Cl3aMeRo.js";import{M as D}from"./mail-COFAZmU7.js";import{L as E}from"./lock-AvWr-ekq.js";import{A as R}from"./arrow-right-DAMjnxuD.js";import"./config-BbshSSl6.js";const B=()=>{const[n,m]=r.useState({username:"",password:""}),[d,l]=r.useState(!1),f=r.useRef(null),h=r.useRef(null),y=r.useRef(null),o=S(),{usid:u}=I(),[g]=L(),j=()=>{const t=localStorage.getItem("loginTime"),a=new Date().getTime(),p=1440*60*1e3;t&&a-t>p&&(localStorage.clear(),i.warning("Session expired. Please login again.",{position:"top-right",autoClose:2e3}),o("/login"))};r.useEffect(()=>{j(),u&&v(u);const t=g.get("phone"),a=g.get("password");t&&a&&(m({username:t,password:a}),b(t,a,!0))},[u,o,g]),r.useEffect(()=>{if(window.location.pathname==="/login"){const t=localStorage.getItem("uid"),a=localStorage.getItem("aid");t>0&&o("/home"),a==="true"&&!t&&o("/admin")}},[o]),r.useEffect(()=>{var t;(t=y.current)==null||t.focus()},[]);const v=async t=>{localStorage.clear();try{l(!0);const{data:a}=await P(`login/${t}`);a?(i.success("Login Successful",{autoClose:2e3}),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("udt",JSON.stringify(a)),localStorage.setItem("uid",a.userID),localStorage.setItem("usid",t),localStorage.setItem("loginTime",new Date().getTime()),o("/home")):i.warning("Kindly login with your credentials",{autoClose:2e3})}catch(a){console.error("Error in direct login:",a)}finally{l(!1)}},b=async(t=n.username,a=n.password,p=!1)=>{if(!t||!a){p||i.error("Please enter both username and password.");return}try{l(!0);const x=await k({mobileNumber:t,password:a}),{code:N,message:w,data:c}=x;N===200?(i.success(w,{autoClose:2e3}),localStorage.clear(),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("udt",JSON.stringify(c)),localStorage.setItem("uid",c.userID),localStorage.setItem("loginTime",new Date().getTime()),t==="7598548786"?(localStorage.setItem("aid","true"),localStorage.setItem("usid",c.usid),o("/admin")):(localStorage.setItem("usid",c.usid),o("/home"))):i.error(w,{autoClose:2e3})}catch(x){i.error("An error occurred: "+x.message,{autoClose:3e3})}finally{l(!1)}};return e.jsxs(e.Fragment,{children:[d&&e.jsx(C,{}),e.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-br from-indigo-50 via-white to-purple-50",children:[e.jsx(s.div,{animate:{rotate:360},transition:{duration:30,repeat:1/0,ease:"linear"},className:"absolute -right-40 -top-40 h-80 w-80 rounded-full bg-indigo-200 opacity-20 blur-3xl"}),e.jsx(s.div,{animate:{rotate:-360},transition:{duration:35,repeat:1/0,ease:"linear"},className:"absolute -left-40 -bottom-40 h-80 w-80 rounded-full bg-purple-200 opacity-20 blur-3xl"}),e.jsx("div",{className:"relative z-10 flex min-h-screen flex-col items-center justify-center px-4 py-12 sm:px-6 lg:px-8",children:e.jsxs(s.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-md",children:[e.jsxs("div",{className:"rounded-3xl bg-white/80 backdrop-blur-sm shadow-2xl p-8 sm:p-10 border border-white/20",children:[e.jsx(s.div,{whileHover:{scale:1.05},className:"text-center mb-8",children:e.jsx("a",{href:"/",children:e.jsx("img",{src:T.LOGO,alt:"Company Logo",className:"mx-auto w-32 sm:w-40"})})}),e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-3",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Sign in to your account to continue learning"})]}),e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"mb-6",children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Mobile Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-indigo-500",size:20}),e.jsx("input",{type:"number",id:"username",ref:y,placeholder:"Enter your mobile number",maxLength:12,tabIndex:"1",value:n.username,onChange:t=>m({...n,username:t.target.value}),onKeyUp:t=>{var a;t.key==="Enter"&&((a=h.current)==null||a.focus())},className:"w-full pl-12 pr-4 py-3 rounded-xl border-2 border-gray-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all duration-300 bg-white"})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},className:"mb-2",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-indigo-500",size:20}),e.jsx("input",{type:"password",id:"password",placeholder:"Enter your password",ref:h,tabIndex:"2",value:n.password,onChange:t=>{const a=t.target.value;if(a.length>8){i.error("Password must be max 8 characters",{autoClose:2e3});return}m({...n,password:a})},onKeyUp:t=>{var a;t.key==="Enter"&&((a=f.current)==null||a.click())},className:"w-full pl-12 pr-4 py-3 rounded-xl border-2 border-gray-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none transition-all duration-300 bg-white"})]})]}),e.jsx("div",{className:"mb-8 text-right",children:e.jsx("a",{href:"/forget-password",className:"text-sm font-medium text-indigo-600 hover:text-purple-600 transition-colors",children:"Forgot your password?"})}),e.jsxs(s.button,{type:"button",ref:f,onClick:()=>b(),whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition-all duration-300 flex items-center justify-center gap-2 group",children:[d?"Logging in...":"Sign In",!d&&e.jsx(R,{className:"group-hover:translate-x-1 transition-transform",size:20})]}),e.jsxs(s.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-8 text-center text-sm text-gray-600",children:["Don't have an account yet?"," ",e.jsx("a",{href:"/register",className:"font-semibold text-indigo-600 hover:text-purple-600 transition-colors",children:"Sign up"})]})]}),e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mt-8 text-center text-xs sm:text-sm text-gray-500",children:e.jsx("p",{children:"Secure login powered by Raah Tech Services"})})]})})]})]})};export{B as default};
