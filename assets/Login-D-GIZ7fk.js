import{r as o,u as N,k as j,l as I,y as r,j as s,L as v,i as p}from"./index-Dr5nTW1o.js";import{l as C}from"./authUtils-Ds1UvVgx.js";const k=()=>{const[l,m]=o.useState({username:"",password:""}),[d,i]=o.useState(!1),g=o.useRef(null),f=o.useRef(null),x=o.useRef(null),a=N(),{usid:c}=j(),b=()=>{const e=localStorage.getItem("loginTime"),t=new Date().getTime(),n=1440*60*1e3;e&&t-e>n&&(localStorage.clear(),r.warning("Session expired. Please login again.",{position:"top-right",autoClose:2e3}),a("/login"))};o.useEffect(()=>{b(),c&&w(c)},[c,a]),o.useEffect(()=>{if(window.location.pathname==="/login"){const e=localStorage.getItem("uid"),t=localStorage.getItem("aid");e>0&&a("/home"),t==="true"&&!e&&a("/admin")}},[a]),o.useEffect(()=>{var e;(e=x.current)==null||e.focus()},[]);const w=async e=>{localStorage.clear();try{i(!0);const{data:t}=await I(`login/${e}`);t?(r.success("Login Successful",{autoClose:2e3}),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("udt",JSON.stringify(t)),localStorage.setItem("uid",t.userID),localStorage.setItem("usid",e),localStorage.setItem("loginTime",new Date().getTime()),a("/home")):r.warning("Kindly login with your credentials",{autoClose:2e3})}catch(t){console.error("Error in direct login:",t)}finally{i(!1)}},y=async()=>{const{username:e,password:t}=l;if(!e||!t){r.error("Please enter both username and password.");return}try{i(!0);const n=await C({mobileNumber:e,password:t}),{code:S,message:h,data:u}=n;S===200?(r.success(h,{autoClose:2e3}),localStorage.clear(),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("udt",JSON.stringify(u)),localStorage.setItem("uid",u.userID),localStorage.setItem("loginTime",new Date().getTime()),e==="admin"?(localStorage.setItem("aid","true"),a("/admin")):(localStorage.setItem("usid",u.usid),a("/home"))):r.error(h,{autoClose:2e3})}catch(n){r.error("An error occurred: "+n.message,{autoClose:3e3})}finally{i(!1)}};return s.jsxs(s.Fragment,{children:[d&&s.jsx(v,{}),s.jsx("div",{className:"hidden md:block absolute inset-0 overflow-hidden z-0",children:s.jsx("img",{src:`${p.BG_PRIMARY}`,alt:"background",className:"w-full h-full object-cover transition-opacity"})}),s.jsx("div",{className:"relative flex min-h-screen items-center justify-center",children:s.jsxs("div",{className:"relative z-10 w-full max-w-md p-8 md:p-12",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("a",{href:"/",children:s.jsx("img",{src:p.LOGO,alt:"Company Logo",className:"mx-auto w-40 md:w-48"})}),s.jsx("h2",{className:"mt-8 text-left text-lg font-semibold text-gray-800",children:"Sign in to your account"}),s.jsx("p",{className:"mb-4 text-left text-xs text-gray-600",children:"Welcome! Please fill in your username and password to log in."})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{htmlFor:"username",className:"mb-2 block text-sm text-gray-600",children:"Mobile Number (as User Name)"}),s.jsx("input",{type:"text",id:"username",ref:x,autoComplete:"off",tabIndex:"1",value:l.username,onChange:e=>m({...l,username:e.target.value}),onKeyUp:e=>{var t;e.key==="Enter"&&((t=f.current)==null||t.focus())},className:"w-full rounded-md border px-3 py-2 focus:border-blue-400 focus:ring focus:ring-blue-300"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{htmlFor:"password",className:"mb-2 block text-sm text-gray-600",children:"Password"}),s.jsx("input",{type:"password",id:"password",ref:f,tabIndex:"2",value:l.password,onChange:e=>{const t=e.target.value;if(t.length>8){r.error("Password must be max 8 characters",{autoClose:2e3});return}m({...l,password:t})},onKeyUp:e=>{var t;e.key==="Enter"&&((t=g.current)==null||t.click())},className:"w-full rounded-md border px-3 py-2 focus:border-blue-400 focus:ring focus:ring-blue-300"}),s.jsx("p",{className:"mt-1 w-full text-end text-xs",children:s.jsx("a",{href:"/forget-password",className:"text-blue-600 hover:underline",children:"Forgot your password?"})})]}),s.jsx("button",{type:"button",ref:g,onClick:y,className:"w-full rounded-md bg-blue-700 px-4 py-2 text-white hover:bg-blue-600 focus:ring focus:ring-blue-300",children:d?"Logging in...":"Login"}),s.jsxs("p",{className:"mt-6 text-center text-sm text-gray-500",children:["Don't have an account yet?"," ",s.jsx("a",{href:"/register",className:"font-medium text-blue-600 hover:underline",children:"Sign up"})]})]})})]})};export{k as default};
