import{r as i,j as e,L as T}from"./index-xBtzwtXX.js";import{C as z}from"./Card-DAEKUoXm.js";import{R as F}from"./react-paginate-BrzmaREY.js";import{e as H,R as I}from"./ApiService-Cx_nAUo6.js";import{C as _,E as $}from"./external-link-B_bbZOyh.js";import{A as L}from"./award-JnFsHSuM.js";import{L as V}from"./lock-QenSlHfA.js";import"./GetAPI-C0R9K2iB.js";import"./config-BbshSSl6.js";const Z=({updateParams:O})=>{const[U,f]=i.useState([]),[m,p]=i.useState([]),[o,h]=i.useState(!0),[y,b]=i.useState(null),[v,P]=i.useState(0),[x]=i.useState(6),N=localStorage.getItem("usid"),S=(t,r)=>{if(!t||!r)return!1;const s=new Date(t),n=new Date;if(isNaN(s.getTime()))return!1;const a=parseInt(r);if(isNaN(a)||a<=0)return!1;const l=a*60*60*1e3;return n-s>=l},M=(t,r)=>{if(!t||!r)return null;try{const s=new Date(t),n=new Date;if(isNaN(s.getTime()))return null;const a=parseInt(r);if(isNaN(a)||a<=0)return null;const l=a*60*60*1e3,d=n-s,c=l-d;if(c<=0)return null;const w=Math.floor(c/(1e3*60*60)),D=Math.floor(c%(1e3*60*60)/(1e3*60)),k=Math.floor(c%(1e3*60)/1e3);return{hours:w,minutes:D,seconds:k,formatted:`${w}h ${D}m ${k}s`}}catch(s){return console.error("Error calculating remaining time:",s),null}},u=i.useCallback(async()=>{if(!N){b("User ID not found. Please log in again."),h(!1);return}try{h(!0),b(null);const t=await H(N);if(t&&t.data){const r=t.data.map(s=>({...s,CourseName:s.CourseName||"Untitled Course",IssueDate:s.IssueDate||s.issueDate||new Date().toISOString().split("T")[0],CertificateLink:s.CertificateLink||s.link||"#",UUID:s.UUID||s.id}));f(r),p(r)}else f([]),p([])}catch(t){console.error("Failed to fetch certificates",t),b(t.message||"Failed to fetch certificates. Please try again."),f([]),p([])}finally{h(!1)}},[N]);i.useEffect(()=>{u()},[u]);const g=v*x,j=m.slice(g,g+x),C=Math.ceil(m.length/x),E=({selected:t})=>{P(t),window.scrollTo({top:0,behavior:"smooth"})},R=t=>{try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return t}},A=(t,r)=>{t.stopPropagation(),window.open(r,"_blank","noopener,noreferrer")};return y&&!o?e.jsxs("div",{className:"flex min-h-[400px] flex-col items-center justify-center text-center",children:[e.jsx(_,{className:"mb-4 h-12 w-12 text-red-500"}),e.jsx("h2",{className:"mb-2 text-xl font-semibold text-gray-900",children:"Something went wrong"}),e.jsx("p",{className:"mb-4 text-gray-600",children:y}),e.jsxs("button",{onClick:u,className:"flex items-center gap-2 rounded-md bg-indigo-600 px-4 py-2 text-white transition-colors hover:bg-indigo-700",children:[e.jsx(I,{size:16}),"Try Again"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Certificates"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:u,disabled:o,className:"flex items-center gap-2 rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-600 transition-colors hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(I,{size:16,className:o?"animate-spin":""}),"Refresh"]})})]}),o&&e.jsx("div",{className:"flex min-h-[400px] items-center justify-center",children:e.jsx(T,{position:"absolute"})}),!o&&U.length===0&&e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(L,{className:"mx-auto mb-4 h-16 w-16 text-gray-300"}),e.jsx("h3",{className:"mb-2 text-lg font-semibold text-gray-900",children:"No certificates earned yet"}),e.jsx("p",{className:"text-gray-600",children:"Complete courses to earn certificates and showcase your achievements."})]}),!o&&j.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:j.map((t,r)=>{var l,d;const s=parseInt(t.CourseCode)||0,n=S(t.created_datetime,s),a=n?null:M(t.created_datetime,s);return e.jsxs("div",{className:"group relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-50 to-purple-50 transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-400/5 to-purple-400/5 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),e.jsx("div",{className:"absolute inset-0 rounded-2xl border border-gradient-to-r from-indigo-200 to-purple-200 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),e.jsxs(z,{className:"relative h-full bg-white/80 backdrop-blur-sm shadow-lg transition-all duration-300 hover:shadow-xl",children:[e.jsx("div",{className:"mb-6 flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"transform rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 p-4 transition-transform duration-300 group-hover:scale-110 group-hover:rotate-6",children:e.jsx(L,{size:32,className:"text-white"})}),e.jsx("div",{children:e.jsx("span",{className:"inline-block rounded-full bg-indigo-100 px-3 py-1 text-xs font-bold tracking-wider text-indigo-700 transition-all duration-300 group-hover:bg-indigo-200",children:"✓ CERTIFIED"})})]})}),e.jsx("h3",{className:"mb-3 line-clamp-2 text-xl font-bold text-gray-900 transition-colors duration-300 group-hover:text-transparent group-hover:bg-gradient-to-r group-hover:from-indigo-600 group-hover:to-purple-600 group-hover:bg-clip-text",children:t.CourseName}),e.jsxs("div",{className:"mb-6 flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"inline-block h-1 w-1 rounded-full bg-indigo-500"}),"Issued on ",R(t.IssueDate)]}),e.jsx("div",{className:"flex-grow"}),e.jsx("div",{className:"border-t border-gray-200 pt-6",children:n?e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("button",{onClick:c=>A(c,t.CertificateLink),className:"group/btn relative flex-1 overflow-hidden rounded-lg bg-gradient-to-r from-indigo-600 to-purple-600 px-4 py-3 font-semibold text-white transition-all duration-300 hover:from-indigo-700 hover:to-purple-700 hover:shadow-lg active:scale-95",children:[e.jsx("div",{className:"absolute inset-0 -translate-x-full transform bg-white/20 transition-transform duration-500 group-hover/btn:translate-x-full"}),e.jsxs("div",{className:"relative flex items-center justify-center gap-2",children:[e.jsx($,{size:18,className:"transition-transform duration-300 group-hover/btn:translate-x-1"}),e.jsx("span",{children:"View Certificate"})]})]}),e.jsxs("div",{className:"rounded-lg bg-gray-100 px-3 py-3 text-center transition-all duration-300 group-hover:bg-gradient-to-br group-hover:from-indigo-100 group-hover:to-purple-100",children:[e.jsx("div",{className:"text-xs font-bold text-gray-600",children:"ID"}),e.jsx("div",{className:"font-mono text-xs font-bold text-gray-800",children:((l=t.UUID)==null?void 0:l.slice(0,8).toUpperCase())||"N/A"})]})]}):e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("button",{disabled:!0,className:"flex items-center justify-center gap-2 rounded-lg bg-gray-300 px-4 py-3 text-xs font-semibold text-gray-600 cursor-not-allowed",title:"Certificate available after course duration",children:[e.jsx(V,{size:16}),"Certificate Locked"]}),a&&e.jsxs("div",{className:"rounded-lg bg-blue-50 p-3 text-center border border-blue-200",children:[e.jsx("p",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Available in:"}),e.jsx("p",{className:"text-xs text-blue-600 font-mono font-bold",children:a.formatted})]}),e.jsxs("div",{className:"rounded-lg bg-gray-100 px-3 py-3 text-center",children:[e.jsx("div",{className:"text-xs font-bold text-gray-600",children:"ID"}),e.jsx("div",{className:"font-mono text-xs font-bold text-gray-800",children:((d=t.UUID)==null?void 0:d.slice(0,8).toUpperCase())||"N/A"})]})]})})]})]},t.UUID||r)})}),C>1&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx(F,{previousLabel:"← Previous",nextLabel:"Next →",pageCount:C,onPageChange:E,forcePage:v,containerClassName:"flex items-center space-x-1",pageClassName:"px-3 py-2 text-sm font-medium text-gray-500 hover:text-gray-700",pageLinkClassName:"block w-full h-full",previousClassName:"px-3 py-2 text-sm font-medium text-gray-500 hover:text-gray-700 disabled:opacity-50",previousLinkClassName:"block w-full h-full",nextClassName:"px-3 py-2 text-sm font-medium text-gray-500 hover:text-gray-700 disabled:opacity-50",nextLinkClassName:"block w-full h-full",activeClassName:"px-3 py-2 text-sm font-medium text-indigo-600 bg-indigo-50 border border-indigo-300 rounded-md",breakClassName:"px-3 py-2 text-sm font-medium text-gray-500",breakLinkClassName:"block w-full h-full",disabledClassName:"opacity-50 cursor-not-allowed"})}),e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["Showing ",g+1," to ",Math.min(g+x,m.length)," of ",m.length," certificates"]})]})]})};export{Z as default};
