import{j as e}from"./index-BKQe61bI.js";import{r as o,e as v}from"./react-vendor-BP6mZlPP.js";import{F as P,_ as x}from"./index-VmDMOnkY.js";import{l as U}from"./rtsApi-CP7Yc0XS.js";import{y as l}from"./ui-vendor-BCREXfKF.js";import{c as g}from"./config-BbshSSl6.js";import"./icons-vendor-CUKBJ_1K.js";import"./GetAPI-C0R9K2iB.js";import"./PostAPI-Dm7qi3aC.js";const R=()=>{const n=localStorage.getItem("rts_user_uuid"),[u,f]=o.useState(""),[a,p]=o.useState(null),[i,h]=o.useState(""),[c,b]=o.useState(""),m=v();o.useEffect(()=>{(async()=>{if(!n)localStorage.clear(),m("/rts/login");else try{const s=await U(n);s?(f(s.user_name),p(s.user_image)):l.error("Something went wrong")}catch(s){console.error("Error fetching user profile:",s)}})()},[n,m]);const w=r=>{const s=r.target.files[0];p(s)},j=async r=>{if(r.preventDefault(),!i){l.error("Current password is required.");return}const s=new FormData;s.append("user_name",u),s.append("current_password",i),c&&s.append("new_password",c),a&&typeof a!="string"&&s.append("user_image",a);for(let[t,d]of s.entries())console.log(t,d);try{await y(`rts/users/${n}/profile`,s)?(l.success("Profile updated successfully"),m("/rts/dashboard")):l.error("Failed to update profile.")}catch(t){l.error("Error updating profile."),console.error("Error updating profile:",t)}},y=async(r,s)=>{try{const t=await fetch(`${g.API_URL}${r}`,{method:"Post",body:s});if(!t.ok){const N=await t.json();throw new Error(N.message||"Network response was not ok")}const d=await t.json();return{status:t.status,data:d}}catch(t){throw console.error("Error in PutAPI:",t),t}};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-xl font-bold mb-4",children:"Edit Profile"}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[a?e.jsx("img",{src:typeof a=="string"?`${g.API_URL}rts/file/get-file?file=${a}`:URL.createObjectURL(a),alt:"Profile",className:"h-24 w-24 rounded-full object-cover"}):e.jsx(P,{className:"h-24 w-24 text-gray-400"}),e.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"bg-white absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsx("span",{className:"text-sm text-gray-500 mt-2",children:"Change Profile Image"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),e.jsx("input",{type:"text",value:u,onChange:r=>f(r.target.value),className:"bg-white  mt-1 block w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Change Password ",e.jsx("span",{className:"text-gray-600 text-sm",children:"(Optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx(x,{className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"password",value:i,onChange:r=>h(r.target.value),className:"bg-white  pl-10 block w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx(x,{className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"password",value:c,onChange:r=>b(r.target.value),className:"bg-white  pl-10 block w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"submit",className:"bg-blue-600 text-white py-2 px-4 rounded-md shadow-md hover:bg-blue-700",children:"Update Profile"})})]})]})};export{R as default};
