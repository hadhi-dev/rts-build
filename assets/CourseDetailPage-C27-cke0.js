import{K as B,V as ee,r as i,j as e,C as se}from"./index-C-EMm4_j.js";import{c as te}from"./config-BbshSSl6.js";import{a as re,R as y,L as P,b as ae,c as ne}from"./ApiService-CStqeEvB.js";import{C as u}from"./index-Il3NMqe8.js";import{C as ie}from"./circle-check-DD37OWRG.js";import{C as le}from"./circle-dashed-RoM8ab25.js";import"./GetAPI-C0R9K2iB.js";import"./menu-Bf-gogJX.js";import"./house-Bg-qiQas.js";import"./award-B4BFCp4c.js";import"./user-C-wE5W1K.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ce=B("Lock",oe);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],me=B("Upload",de),ve=({updateParams:U})=>{var M,$,F;const[_]=ee(),p=_.get("uuid"),[b,q]=i.useState(null),[C,S]=i.useState(!0),[D,v]=i.useState(null),[l,T]=i.useState(null),[o,I]=i.useState(null),[O,z]=i.useState(!1),[h,k]=i.useState({}),[c,A]=i.useState(null),[Q,w]=i.useState("course"),j=()=>{U({pg:"courses",uuid:void 0})},f=i.useCallback(async()=>{if(p)try{S(!0),v(null);const s=await re(p);console.log("courseResult",s),s!=null&&s.data&&q(s.data)}catch(s){console.error("Failed to fetch courses",s),v("Failed to load course details")}finally{S(!1)}},[p]),R=async s=>{try{z(!0);const t=await ne(s);console.log("mcqResult",t),t!=null&&t.data&&(I(t.data),k({}))}catch(t){console.error("Failed to fetch MCQ data",t),v("Failed to load MCQ questions")}finally{z(!1)}};i.useEffect(()=>{f()},[f]);const E=()=>{const s=`${te.API_URL}certificate/${p}`,t=document.createElement("a");t.href=s,t.target="_blank",t.rel="noopener noreferrer",document.body.appendChild(t),t.click(),document.body.removeChild(t)},V=async s=>{const t=await ae(USid,s.TaskID);T(t.data),s.TaskType==="MCQ"?(R(s.TaskID),w("mcq")):w("task")},N=()=>{w("course"),T(null),I(null),A(null),k({})},H=s=>s.IsComplete===1?"Completed":s.Status==="open"?"Available":"Locked",G=s=>{switch(s){case"Completed":return"bg-green-100 text-green-700";case"Available":return"bg-blue-100 text-blue-700";case"Locked":return"bg-gray-100 text-gray-500";default:return"bg-gray-100 text-gray-700"}},K=(s,t,a)=>{if(t===0)return!0;for(let n=0;n<t;n++)if(a[n].IsComplete===0)return!1;return!0},Y=s=>s&&s.length>0&&s.every(t=>t.IsComplete===1),J=s=>{const t=s.target.files[0];if(t){if(t.size>5*1024*1024){alert("File size must be less than 5MB");return}if(t.type!=="application/pdf"){alert("Only PDF files are allowed");return}A(t)}},W=()=>{if(!c){alert("Please upload a PDF file");return}console.log("Assignment submitted:",{taskId:l.TaskID,file:c,fileName:c.name,fileSize:c.size}),alert("Assignment submitted successfully!"),N()},X=(s,t)=>{k(a=>({...a,[s]:t}))},Z=()=>{var m;const s=((m=o==null?void 0:o.mcqs)==null?void 0:m.length)||0,t=Object.keys(h).length;if(t<s){alert(`Please answer all questions. ${t}/${s} answered.`);return}const a=o.mcqs.map(d=>({questionId:d.QuestionID,question:d.question,userAnswer:h[d.QuestionID],correctAnswer:d.answer,isCorrect:h[d.QuestionID]===d.answer}));console.log("MCQ Responses:",a);const n=a.filter(d=>d.isCorrect).length,x=(n/s*100).toFixed(1);alert(`Quiz completed! Score: ${n}/${s} (${x}%)`),N()};if(C)return e.jsxs("section",{children:[e.jsxs("button",{onClick:()=>j(),className:"mb-4 flex items-center font-medium text-indigo-600 transition-colors hover:text-indigo-800",children:[e.jsx(u,{size:16,className:"mr-1"}),"Back to Courses"]}),e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(y,{size:24,className:"animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading course details..."})]})]});if(D)return e.jsxs("section",{children:[e.jsxs("button",{onClick:()=>j(),className:"mb-4 flex items-center font-medium text-indigo-600 transition-colors hover:text-indigo-800",children:[e.jsx(u,{size:16,className:"mr-1"}),"Back to Courses"]}),e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"mb-4 text-red-600",children:D}),e.jsxs("button",{onClick:f,className:"mx-auto flex items-center gap-2 rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700",children:[e.jsx(y,{size:16}),"Try Again"]})]})]});if(!(b!=null&&b.course))return e.jsxs("section",{children:[e.jsxs("button",{onClick:()=>j(),className:"mb-4 flex items-center font-medium text-indigo-600 transition-colors hover:text-indigo-800",children:[e.jsx(u,{size:16,className:"mr-1"}),"Back to Courses"]}),e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No course data found"})})]});const{course:r,tasks:L}=b,g=L?[...L].sort((s,t)=>s.TaskOrderNo-t.TaskOrderNo):[];return Q==="task"&&l?e.jsxs("section",{children:[e.jsxs("button",{onClick:N,className:"mb-4 flex items-center font-medium text-indigo-600 transition-colors hover:text-indigo-800",children:[e.jsx(u,{size:16,className:"mr-1"}),"Back to Course"]}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"mb-2 text-2xl font-bold text-gray-900",children:l.TaskName}),e.jsxs("div",{className:"mb-4 flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Task Code: ",l.TaskCode]}),e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800",children:l.TaskType})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-800",children:"Description"}),e.jsx("p",{className:"leading-relaxed text-gray-700",children:l.ShortDescription})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-800",children:"Submit Assignment"}),e.jsxs("div",{className:"rounded-lg border-2 border-dashed border-gray-300 p-8 text-center transition-colors hover:border-indigo-400",children:[e.jsx(me,{size:48,className:"mx-auto mb-4 text-gray-400"}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Click to upload"}),e.jsx("span",{className:"text-gray-600",children:" or drag and drop"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf",onChange:J})]})}),e.jsx("p",{className:"text-sm text-gray-500",children:"PDF files only, up to 5MB"}),c&&e.jsxs("div",{className:"mt-4 rounded-md border border-green-200 bg-green-50 p-3",children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:c.name}),e.jsxs("p",{className:"text-xs text-green-600",children:[(c.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsx("button",{onClick:W,disabled:!c,className:"mt-6 w-full rounded-md bg-indigo-600 px-4 py-3 font-medium text-white transition-colors hover:bg-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-300",children:"Submit Assignment"})]})]})})]}):Q==="mcq"&&l&&o?e.jsxs("section",{children:[e.jsxs("button",{onClick:N,className:"mb-4 flex items-center font-medium text-indigo-600 transition-colors hover:text-indigo-800",children:[e.jsx(u,{size:16,className:"mr-1"}),"Back to Course"]}),e.jsxs("div",{className:"max-w-4xl",children:[e.jsxs("div",{className:"mb-6 rounded-lg border border-gray-200 bg-white p-6",children:[e.jsx("h1",{className:"mb-2 text-2xl font-bold text-gray-900",children:l.TaskName}),e.jsx("p",{className:"mb-4 text-gray-600",children:l.ShortDescription}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[((M=o.mcqs)==null?void 0:M.length)||0," Questions"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Answered: ",Object.keys(h).length,"/",(($=o.mcqs)==null?void 0:$.length)||0]})]})]}),O?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(y,{size:24,className:"animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading questions..."})]}):e.jsxs("div",{className:"space-y-6",children:[(F=o.mcqs)==null?void 0:F.map((s,t)=>e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6",children:[e.jsxs("h3",{className:"mb-4 text-lg font-semibold text-gray-800",children:[t+1,". ",s.question]}),e.jsx("div",{className:"space-y-3",children:s.options.map((a,n)=>{const x=String.fromCharCode(65+n),m=h[s.QuestionID]===x;return e.jsxs("label",{className:`flex cursor-pointer items-center rounded-md p-3 transition-colors ${m?"border-2 border-indigo-200 bg-indigo-50":"border border-gray-200 bg-gray-50 hover:bg-gray-100"}`,children:[e.jsx("input",{type:"radio",name:`question-${s.QuestionID}`,value:x,checked:m,onChange:()=>X(s.QuestionID,x),className:"mr-3"}),e.jsxs("span",{className:`mr-2 font-medium ${m?"text-indigo-700":"text-gray-600"}`,children:[x,"."]}),e.jsx("span",{className:m?"text-indigo-700":"text-gray-800",children:a})]},n)})})]},s.QuestionID)),e.jsx("button",{onClick:Z,className:"w-full rounded-md bg-indigo-600 px-4 py-3 font-medium text-white transition-colors hover:bg-indigo-700",children:"Submit Quiz"})]})]})]}):e.jsxs("section",{children:[e.jsxs("button",{onClick:()=>j(),className:"mb-4 flex items-center font-medium text-indigo-600 transition-colors hover:text-indigo-800",children:[e.jsx(u,{size:16,className:"mr-1"}),"Back to Courses"]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:r.CourseName}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Code: ",r.CourseCode]}),e.jsxs("span",{children:["Department: ",r.Department]}),e.jsxs("span",{children:["Instructor: ",r.InstructorName]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:f,disabled:C,className:"flex items-center gap-2 rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-600 transition-colors hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(y,{size:16,className:C?"animate-spin":""}),"Refresh"]})})]}),r.ShortDescription&&e.jsx("p",{className:"mb-2 text-gray-600",children:r.ShortDescription}),e.jsxs("details",{className:"mb-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-indigo-600",children:"View Full Description"}),e.jsx("div",{className:"mt-2 max-h-60 overflow-y-auto text-sm",dangerouslySetInnerHTML:{__html:r.Description||"<p>No full description available.</p>"}})]}),e.jsx("div",{className:"mb-6 rounded-lg border border-gray-200 bg-white p-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 text-sm md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Amount:"}),e.jsxs("span",{className:"ml-2",children:["$",r.Amount]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Course Status:"}),e.jsx("span",{className:`ml-2 inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${r.IsComplete?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:r.IsComplete?"Course Complete":"In Progress"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Payment:"}),e.jsx("span",{className:`ml-2 inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${r.IsPaid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:r.IsPaid?"Paid":"Unpaid"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Certificate:"}),r.IsCertified?e.jsx("button",{onClick:E,className:"ml-2 inline-flex items-center rounded-md bg-blue-100 px-2 py-1 text-xs font-medium text-blue-700 transition-colors hover:bg-blue-200",children:"View Certificate"}):e.jsx("span",{className:"ml-2 inline-flex items-center rounded-full bg-gray-100 px-2 py-1 text-xs font-medium text-gray-700",children:"Not Available"})]})]})}),Y(g)&&e.jsx("div",{className:"mb-6 rounded-lg border border-green-200 bg-green-50 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{size:24,className:"mr-3 text-green-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"All Tasks Completed! ðŸŽ‰"}),e.jsx("p",{className:"text-green-700",children:"Congratulations! You have successfully completed all course tasks."})]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(P,{size:20,className:"text-gray-700"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Course Tasks"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",g.length," tasks)"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto rounded-lg border border-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-left text-sm font-medium text-gray-600",children:[e.jsx("th",{className:"border-b border-gray-200 p-4",children:"#"}),e.jsx("th",{className:"border-b border-gray-200 p-4",children:"Task Name"}),e.jsx("th",{className:"border-b border-gray-200 p-4",children:"Type"}),e.jsx("th",{className:"border-b border-gray-200 p-4",children:"Description"}),e.jsx("th",{className:"border-b border-gray-200 p-4",children:"Status"}),e.jsx("th",{className:"border-b border-gray-200 p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:g.length>0?g.map((s,t)=>{const a=H(s),n=K(s,t,g);return e.jsxs("tr",{className:"text-sm text-gray-800 hover:bg-gray-50",children:[e.jsx("td",{className:"p-4 font-medium",children:t+1}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium",children:s.TaskName}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Code: ",s.TaskCode]})]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center rounded-md bg-gray-100 px-2 py-1 text-xs font-medium text-gray-800",children:s.TaskType})}),e.jsx("td",{className:"max-w-xs p-4",children:e.jsx("p",{className:"truncate",title:s.ShortDescription,children:s.ShortDescription})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${G(a)}`,children:a})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"flex items-center gap-2",children:s.IsComplete===1?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(ie,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-xs",children:"Completed"})]}):n?e.jsxs("button",{onClick:()=>V(s),className:"flex items-center rounded-md bg-indigo-500 px-3 py-1.5 text-xs font-medium text-white transition-colors hover:bg-indigo-600",children:[e.jsx(le,{size:14,className:"mr-1"}),"Open Task"]}):e.jsxs("div",{className:"flex items-center text-gray-400",children:[e.jsx(ce,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-xs",children:"Locked"})]})})})]},s.TaskID)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"p-8 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(P,{size:48,className:"mb-2 text-gray-300"}),e.jsx("p",{children:"No tasks available for this course."})]})})})})]})})]})]})]})};export{ve as default};
